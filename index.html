<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Neon Vector Escape</title>
<style>
  html,body{margin:0;background:#05050a;overflow:hidden;font-family:Arial}
  #wrap{display:flex;justify-content:center;align-items:center;height:100vh}
  canvas{background:#0d0d17;border:2px solid #222;border-radius:10px;box-shadow:0 0 20px #000}
  #ui{position:absolute;top:10px;left:20px;color:#6bf;font-size:22px;font-weight:bold;text-shadow:0 0 6px #49f}
  #hi{position:absolute;top:10px;right:20px;color:#6bf;font-size:22px;font-weight:bold;text-shadow:0 0 6px #49f}
</style>
</head>
<body>
<div id="wrap">
  <canvas id="game" width="420" height="560"></canvas>
  <div id="ui">0</div>
  <div id="hi">HIGH: 0</div>
</div>
<script>
(function(){
  const c=document.getElementById("game"),x=c.getContext("2d");
  const W=c.width,H=c.height;
  const ui=document.getElementById("ui");
  const hi=document.getElementById("hi");

  let highScore=parseInt(localStorage.getItem("nve_highscore")||"0");
  hi.textContent="HIGH: "+highScore;

  let running=true;
  let player, obstacles, score, mouse, timer;

  function reset(){
    player={x:W/2,y:H/2,size:18};
    obstacles=[];
    score=0;
    timer=0;
    mouse={x:W/2,y:H/2};
  }

  function saveHigh(){
    if(score>highScore){
      highScore=Math.floor(score);
      localStorage.setItem("nve_highscore",highScore);
      hi.textContent="HIGH: "+highScore;
    }
  }

  c.addEventListener("mousemove",e=>{
    const r=c.getBoundingClientRect();
    mouse.x=e.clientX-r.left;
    mouse.y=e.clientY-r.top;
  });

  c.addEventListener("touchmove",e=>{
    e.preventDefault();
    const t=e.touches[0],r=c.getBoundingClientRect();
    mouse.x=t.clientX-r.left;
    mouse.y=t.clientY-r.top;
  },{passive:false});

  function spawnObstacle(){
    const s=20+Math.random()*40;
    const side=Math.floor(Math.random()*4);
    let xPos, yPos, vx, vy;

    if(side===0){xPos=Math.random()*W;yPos=-50;vx=(Math.random()-0.5)*40;vy=60+Math.random()*120;}
    if(side===1){xPos=W+50;yPos=Math.random()*H;vx=-(60+Math.random()*120);vy=(Math.random()-0.5)*40;}
    if(side===2){xPos=Math.random()*W;yPos=H+50;vx=(Math.random()-0.5)*40;vy=-(60+Math.random()*120);}
    if(side===3){xPos=-50;yPos=Math.random()*H;vx=60+Math.random()*120;vy=(Math.random()-0.5)*40;}

    obstacles.push({x:xPos,y:yPos,size:s,vx,vy,rot:0,rs:(Math.random()-0.5)*2});
  }

  function collide(a,b){
    const dx=a.x-b.x,dy=a.y-b.y;
    return Math.hypot(dx,dy) < (a.size+b.size)*0.6;
  }

  let last=0;
  function loop(t){
    if(!running)return;
    const dt=Math.min(0.03,(t-last)/1000); last=t;

    player.x += (mouse.x - player.x)*6*dt;
    player.y += (mouse.y - player.y)*6*dt;

    timer+=dt;
    if(timer>0.8){timer=0;spawnObstacle();}

    for(let i=obstacles.length-1;i>=0;i--){
      const o=obstacles[i];
      o.x+=o.vx*dt;
      o.y+=o.vy*dt;
      o.rot+=o.rs*dt;
      if(o.x<-80||o.x>W+80||o.y<-80||o.y>H+80) obstacles.splice(i,1);
    }

    for(let o of obstacles){
      if(collide(player,o)){
        saveHigh();
        reset();
      }
    }

    score += dt*2; // MUCH slower scoring
    ui.textContent=Math.floor(score);

    render();
    requestAnimationFrame(loop);
  }

  function render(){
    x.clearRect(0,0,W,H);

    x.fillStyle="#6bf";
    x.beginPath();
    x.arc(player.x,player.y,player.size,0,Math.PI*2);
    x.fill();

    x.strokeStyle="#f55";
    x.lineWidth=3;
    obstacles.forEach(o=>{
      x.save();
      x.translate(o.x,o.y);
      x.rotate(o.rot);
      x.strokeRect(-o.size/2,-o.size/2,o.size,o.size);
      x.restore();
    });
  }

  reset();
  last=performance.now();
  loop(last);
})();
</script>
</body>
</html>

